Bootstrap: docker
From: nvcr.io/nvidia/nvhpc:22.5-devel-cuda11.7-ubuntu20.04


%environment
	# pyenv
	export PYTHON_VERSION="3.9.5"
	export PYENV_ROOT="/pyenv"
	export PATH="$PYENV_ROOT/bin:$PATH"
	eval "$(pyenv init -)"


%post
	apt-get update
	DEBIAN_FRONTEND=noninteractive apt-get install -y \
	sudo \
	ca-certificates \
	git \
	curl \
	patch \
	make \
	cmake \
	gcc \
	g++ \
	openssl \
	libssl-dev \
	libbz2-dev \
	libreadline-dev \
	libsqlite3-dev \
	libffi-dev \
	zlib1g-dev \
	liblzma-dev

	# export PYENV_ROOT="/pyenv"
	# git clone https://github.com/pyenv/pyenv.git ${PYENV_ROOT}
	# export PATH="$PYENV_ROOT/bin:$PATH"
	# eval "$(pyenv init -)"
	# export PYTHON_VERSION="3.9.5"
	# pyenv install ${PYTHON_VERSION}
	# pyenv global ${PYTHON_VERSION}
	# pyenv rehash
	# python -m pip install --upgrade pip
	# pip install matplotlib mpi4py

	# clean up
	apt-get clean
	rm -rf /var/lib/apt/lists/*
